<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>Class 3: Architect, build and deploy AI Services</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="Class 3: Architect, build and deploy AI Services"/>
  <meta name="product" content="Secure, Deliver and Optimize GenAI Apps with F5"/>
  <meta name="version" content="latest"/>
  <meta name="updated_date"  content="2024-12-17 10:43:27"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="Secure, Deliver and Optimize GenAI Apps with F5" content="latest"/>


  <!-- Version selector meta tags-->
  <meta name="version_meta_path" content="/training/community/template/versions.json">
  <meta name="project_safe" content="SecureDeliverandOptimizeGenAIAppswithF5">
  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Class 3: Architect, build and deploy AI Services &#8212; Secure, Deliver and Optimize GenAI Apps with F5 </title>
    <link rel="stylesheet" href="../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/f5.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/f5-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/CoveoFullSearch.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/21fb8a09c3.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/clipboard.min.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Class 4: Enhance Modern Application with GenAI ChatBot" href="../class4/class4.html" />
    <link rel="prev" title="Class 2: Deploy and Secure a modern application" href="../class2/class2.html" /> 
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="sidebar" class="section-nav">
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
        <h5>Secure, Deliver and Optimize GenAI Apps with F5 latest </h5>
        

        <hr>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/introduction.html">Introduction - GenAI Practitioner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prerequisite/prerequisite.html">Prerequsite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class1/class1.html">Class 1: The fundamental of Generative Artificial Intelligent (AI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class2/class2.html">Class 2: Deploy and Secure a modern application</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Class 3: Architect, build and deploy AI Services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#conceptual-architecture-of-ai-services">1 - Conceptual Architecture of AI Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deploy-nginx-ingress-controller-for-aigw-k8s">2 - Deploy Nginx Ingress Controller for AIGW K8S</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deploy-open-webui-with-ollama-service">3 - Deploy Open-WebUI with Ollama Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="#download-language-model">4 - Download Language Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deploy-llm-model-service">5 - Deploy LLM model service</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deploy-llm-orchestrator-service">6 - Deploy LLM orchestrator service</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deploy-vector-database">7 - Deploy Vector Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#build-rag-pipeline-with-langchain">8 - Build RAG pipeline with Langchain</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vectorize-proprietary-data">Vectorize Proprietary Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test-your-first-gen-ai-rag-chatbot">Test your first Gen AI RAG Chatbot</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../class4/class4.html">Class 4: Enhance Modern Application with GenAI ChatBot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class5/class5.html">Class 5: Secure, Deliver and Optimize GenAI ChatBot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class6/class6.html">Class 6: AI Operations and Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class7/class7.html">Class 7: Externalize Modern Apps with GenAI Services with F5XC Global DMZ</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">Class 3: Architect, build and deploy AI Services</a><ul>
<li><a class="reference internal" href="#conceptual-architecture-of-ai-services">1 - Conceptual Architecture of AI Services</a></li>
<li><a class="reference internal" href="#deploy-nginx-ingress-controller-for-aigw-k8s">2 - Deploy Nginx Ingress Controller for AIGW K8S</a></li>
<li><a class="reference internal" href="#deploy-open-webui-with-ollama-service">3 - Deploy Open-WebUI with Ollama Service</a></li>
<li><a class="reference internal" href="#download-language-model">4 - Download Language Model</a></li>
<li><a class="reference internal" href="#deploy-llm-model-service">5 - Deploy LLM model service</a></li>
<li><a class="reference internal" href="#deploy-llm-orchestrator-service">6 - Deploy LLM orchestrator service</a></li>
<li><a class="reference internal" href="#deploy-vector-database">7 - Deploy Vector Database</a></li>
<li><a class="reference internal" href="#build-rag-pipeline-with-langchain">8 - Build RAG pipeline with Langchain</a><ul>
<li><a class="reference internal" href="#vectorize-proprietary-data">Vectorize Proprietary Data</a></li>
<li><a class="reference internal" href="#test-your-first-gen-ai-rag-chatbot">Test your first Gen AI RAG Chatbot</a></li>
</ul>
</li>
</ul>
</li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
              <!-- custom breadcrumb -->
        <h5>
            <a href="../index.html">Secure, Deliver and Optimize GenAI Apps with F5</a>

          <span class="right">
             <a href="../_sources/class3/class3.rst.txt" rel="nofollow">Source</a> |
             <a href="https://github.com/f5devcentral/f5-agility-labs-template">Edit on <i class="fa fa-github" aria-hidden="true"></i></a>
          </span>
        </h5>
        <!-- end custom breadcrumb -->
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="class-3-architect-build-and-deploy-ai-services">
<h1>Class 3: Architect, build and deploy AI Services<a class="headerlink" href="#class-3-architect-build-and-deploy-ai-services" title="Permalink to this headline">¶</a></h1>
<img alt="../_images/mission3.png" src="../_images/mission3.png" />
<p>With the growing popularity of Generative AI, your organization has decided to upgrade the Arcadia trading platform by integrating a Generative AI (GenAI) chatbot. Below is the conceptual architecture of the AI Services setup.</p>
<div class="section" id="conceptual-architecture-of-ai-services">
<h2>1 - Conceptual Architecture of AI Services<a class="headerlink" href="#conceptual-architecture-of-ai-services" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/class3-1.png" src="../_images/class3-1.png" />
</div>
<div class="section" id="deploy-nginx-ingress-controller-for-aigw-k8s">
<h2>2 - Deploy Nginx Ingress Controller for AIGW K8S<a class="headerlink" href="#deploy-nginx-ingress-controller-for-aigw-k8s" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/ai-gateway/nginx-ingress
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl create ns nginx-ingress
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>helm -n nginx-ingress install nginxic <span class="se">\</span>
oci://ghcr.io/nginxinc/charts/nginx-ingress -f values.yaml --version <span class="m">1</span>.4.0
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl -n nginx-ingress get pod,svc
</pre></div>
</div>
<img alt="../_images/class3-2.png" src="../_images/class3-2.png" />
</div>
<div class="section" id="deploy-open-webui-with-ollama-service">
<h2>3 - Deploy Open-WebUI with Ollama Service<a class="headerlink" href="#deploy-open-webui-with-ollama-service" title="Permalink to this headline">¶</a></h2>
<p>Ensure you on ai-gateway directory</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/ai-gateway
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> open-webui-helm-charts/
</pre></div>
</div>
<img alt="../_images/class3-3.png" src="../_images/class3-3.png" />
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>helm repo add open-webui https://open-webui.github.io/helm-charts
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>helm repo list
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl create ns open-webui
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>helm -n open-webui install open-webui open-webui/open-webui --values values.yaml
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl -n open-webui get pod,svc
</pre></div>
</div>
<img alt="../_images/class3-4.png" src="../_images/class3-4.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ensure all pods are in <strong>Running</strong> and <strong>READY</strong> state where all pods count ready before proceed.</p>
</div>
<p>Create nginx ingress resource for open-webui to expose Open-Webui service to outside of K8S.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/ai-gateway/nginx-ingress-open-webui/
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls -l
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl -n open-webui apply -f open-webui-ingress-https.yaml
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl -n open-webui apply -f ollama-ingress-http.yaml
</pre></div>
</div>
<img alt="../_images/class3-5.png" src="../_images/class3-5.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Feel free to explore the content of those ingress resource to understand how those services being exposed.</p>
</div>
<p>From Chrome browser, confirm you can access to Open-Webui service.</p>
<img alt="../_images/class3-6.png" src="../_images/class3-6.png" />
<p>First time sign up a new user (any abitary name). Make sure you remember or use the suggested name</p>
<table border="1" class="docutils">
<colgroup>
<col width="52%" />
<col width="48%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Name</strong></td>
<td>F5 AI</td>
</tr>
<tr class="row-even"><td><strong>Email</strong></td>
<td><a class="reference external" href="mailto:f5ai&#37;&#52;&#48;f5&#46;com">f5ai<span>&#64;</span>f5<span>&#46;</span>com</a></td>
</tr>
<tr class="row-odd"><td><strong>Password</strong></td>
<td>F5Passw0rd</td>
</tr>
</tbody>
</table>
<img alt="../_images/class3-7.png" src="../_images/class3-7.png" />
<p>Successfully signup and login to Open-WebUI</p>
<img alt="../_images/class3-8.png" src="../_images/class3-8.png" />
</div>
<div class="section" id="download-language-model">
<h2>4 - Download Language Model<a class="headerlink" href="#download-language-model" title="Permalink to this headline">¶</a></h2>
<p>From Open WebUI, type the model name onto the search button and hover mouse to the click “Pull “xxxxxx” from Ollama.com” to pull the model down and host it locally.</p>
<img alt="../_images/class3-9.png" src="../_images/class3-9.png" />
<img alt="../_images/class3-10.png" src="../_images/class3-10.png" />
<p>Repeat the above to download the following LLM model</p>
<table border="1" class="docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Model</strong></th>
<th class="head"><strong>Name</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>tinyllama</td>
<td>The TinyLlama project (1.1b)</td>
</tr>
<tr class="row-odd"><td>phi3</td>
<td>Microsoft (3.8b)</td>
</tr>
<tr class="row-even"><td>phi3.5</td>
<td>Microsoft (3.8b)</td>
</tr>
<tr class="row-odd"><td>llama3.2:1b</td>
<td>Meta Llama3.2 (1b)</td>
</tr>
<tr class="row-even"><td>qwen2.5:1.5b</td>
<td>Alibaba Cloud Qwen2 (1.5b)</td>
</tr>
<tr class="row-odd"><td>hangyang/rakutenai-7b-chat</td>
<td>Rakuten AI (7b)</td>
</tr>
<tr class="row-even"><td>nomic-embed-text</td>
<td>Open embedding model</td>
</tr>
</tbody>
</table>
<p>Ensure you have all the model downloaded before you proceed.</p>
<img alt="../_images/class3-11.png" src="../_images/class3-11.png" />
<p>Test interacting with LLM model. Feel free to test with different language model.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Please do note that UDF environment were setup with CPU (no GPU). Hence, all model inference will run on CPU instead of GPU. Performance may not be optimum but should be acceptable for lab. Please be patience as it depends on CPU consumption at that time of inference. First inference of the model may be slow and should be alright after that.</p>
</div>
<img alt="../_images/class3-12.png" src="../_images/class3-12.png" />
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Hallucinations -  xxxx .</p>
</div>
</div>
<div class="section" id="deploy-llm-model-service">
<h2>5 - Deploy LLM model service<a class="headerlink" href="#deploy-llm-model-service" title="Permalink to this headline">¶</a></h2>
<p>Ollama API being exposed from previous step (step 3 above).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Ollama API is currently exposed over HTTP instead of HTTPS. This is due to a limitation in the LLM orchestrator (FlowiseAI), which does not natively support self-signed certificates without some environment changes. To simplify the setup and eliminate resources consumption for encryption/decryption so that more CPU can be dedicated for inference, HTTP is used instead of HTTPS. However, all communication between the LLM orchestrator and other AI components occurs internally, within a controlled environment.</p>
</div>
<p>Ollama API is the model serving endpoint. Since we are running inference from CPU, it will take a while for ollama to response to user. To ensure connections is not time on NGINX ingress, we need to increase the timeout on NGINX ingress for ollama. This nginx ingress resource for ollama had been deployed in step 3 above.</p>
<p>ollama-ingress-http.yaml</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apiVersion</span><span class="p">:</span> <span class="n">networking</span><span class="o">.</span><span class="n">k8s</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1</span>
<span class="n">kind</span><span class="p">:</span> <span class="n">Ingress</span>
<span class="n">metadata</span><span class="p">:</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">ollama</span><span class="o">-</span><span class="n">http</span><span class="o">-</span><span class="n">ic</span>
  <span class="n">annotations</span><span class="p">:</span>
    <span class="n">nginx</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">proxy</span><span class="o">-</span><span class="n">connect</span><span class="o">-</span><span class="n">timeout</span><span class="p">:</span> <span class="s2">&quot;120s&quot;</span>
    <span class="n">nginx</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">proxy</span><span class="o">-</span><span class="n">read</span><span class="o">-</span><span class="n">timeout</span><span class="p">:</span> <span class="s2">&quot;120s&quot;</span>
    <span class="n">nginx</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">proxy</span><span class="o">-</span><span class="n">send</span><span class="o">-</span><span class="n">timeout</span><span class="p">:</span> <span class="s2">&quot;120s&quot;</span>
<span class="n">spec</span><span class="p">:</span>
  <span class="n">ingressClassName</span><span class="p">:</span> <span class="n">nginx</span><span class="o">-</span><span class="n">ingress</span>
  <span class="n">rules</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">host</span><span class="p">:</span> <span class="n">ollama</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">local</span>
    <span class="n">http</span><span class="p">:</span>
      <span class="n">paths</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">path</span><span class="p">:</span> <span class="o">/</span>
        <span class="n">pathType</span><span class="p">:</span> <span class="n">Prefix</span>
        <span class="n">backend</span><span class="p">:</span>
          <span class="n">service</span><span class="p">:</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">open</span><span class="o">-</span><span class="n">webui</span><span class="o">-</span><span class="n">ollama</span>
            <span class="n">port</span><span class="p">:</span>
               <span class="n">number</span><span class="p">:</span> <span class="mi">11434</span>
</pre></div>
</div>
</div>
<div class="section" id="deploy-llm-orchestrator-service">
<h2>6 - Deploy LLM orchestrator service<a class="headerlink" href="#deploy-llm-orchestrator-service" title="Permalink to this headline">¶</a></h2>
<p>Deploy LLM Orchstrator to facilitate AI component communication. Flowise AI - an open source low-code tool for developer to build customized LLM orchstration flow and AI agent is used. (<a class="reference external" href="https://flowiseai.com/">https://flowiseai.com/</a>). Flowise leverages langchain framework.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/webapps/
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/webapps/flowiseai
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>helm repo add cowboysysop https://cowboysysop.github.io/charts/
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl create ns flowiseai
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>helm -n flowiseai install flowiseai --values values.yaml cowboysysop/flowise
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl -n flowiseai get po,svc
</pre></div>
</div>
<img alt="../_images/class3-13.png" src="../_images/class3-13.png" />
<p>Flowise is installed with the following custom values. You can login with the password shown in the value file.</p>
<p>values.yaml</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image</span><span class="p">:</span>
  <span class="n">registry</span><span class="p">:</span> <span class="n">docker</span><span class="o">.</span><span class="n">io</span>
  <span class="n">repository</span><span class="p">:</span> <span class="n">flowiseai</span><span class="o">/</span><span class="n">flowise</span>
  <span class="n">tag</span><span class="p">:</span> <span class="mf">2.1</span><span class="o">.</span><span class="mi">5</span>

<span class="n">serviceAccount</span><span class="p">:</span>
  <span class="n">create</span><span class="p">:</span> <span class="n">true</span>

<span class="n">resources</span><span class="p">:</span>
   <span class="n">limits</span><span class="p">:</span>
     <span class="n">cpu</span><span class="p">:</span> <span class="mi">4000</span><span class="n">m</span>
     <span class="n">memory</span><span class="p">:</span> <span class="mi">8</span><span class="n">Gi</span>
   <span class="n">requests</span><span class="p">:</span>
     <span class="n">cpu</span><span class="p">:</span> <span class="mi">4000</span><span class="n">m</span>
     <span class="n">memory</span><span class="p">:</span> <span class="mi">8</span><span class="n">Gi</span>

<span class="n">persistence</span><span class="p">:</span>
  <span class="n">enabled</span><span class="p">:</span> <span class="n">true</span>
  <span class="n">size</span><span class="p">:</span> <span class="mi">5</span><span class="n">Gi</span>

<span class="n">config</span><span class="p">:</span>
  <span class="n">username</span><span class="p">:</span> <span class="s2">&quot;admin&quot;</span>
  <span class="n">password</span><span class="p">:</span> <span class="s2">&quot;F5Passw0rd&quot;</span>

<span class="n">extraEnvVars</span><span class="p">:</span>
 <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">LOG_LEVEL</span>
   <span class="n">value</span><span class="p">:</span> <span class="s1">&#39;debug&#39;</span>
 <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">DEBUG</span>
   <span class="n">value</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span>
</pre></div>
</div>
<p>Create nginx ingress resource for flowise to expose flowise service to outside of K8S.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl -n flowiseai apply -f flowise-ingress.yaml
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl -n flowiseai get ingress
</pre></div>
</div>
<img alt="../_images/class3-14.png" src="../_images/class3-14.png" />
<p>Confirm that you can login and access to LLM orchestrator (flowise)</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">If no login prompt as shown below, likely credential was cache in the browser during the building phase of the lab. You can either do a clear browser cache or safely ignore if it doesn’t ask for password.</p>
</div>
<img alt="../_images/class3-15.png" src="../_images/class3-15.png" />
<p>Import arcadia RAG chatflow into flowise. Select settings icons and <strong>Load Chatflow</strong></p>
<img alt="../_images/class3-16.png" src="../_images/class3-16.png" />
<p>A copy of the chatflow located on the jumphost <strong>Documents</strong> directory. Select the chatflow json file.</p>
<img alt="../_images/class3-17.png" src="../_images/class3-17.png" />
<p>Save the chatflow with a name as shown.</p>
<img alt="../_images/class3-18.png" src="../_images/class3-18.png" />
<p>To successfully build the full langchain pipeline / chatflow, you need to upload organization context information into the RAG pipeline. Arcadia context information file located in the <strong>Documents</strong> directory. Under “Text File” node, Click “Upload File”</p>
<img alt="../_images/class3-19.png" src="../_images/class3-19.png" />
<p>Save the chatflow with a name as shown.</p>
<img alt="../_images/class3-20.png" src="../_images/class3-20.png" />
</div>
<div class="section" id="deploy-vector-database">
<h2>7 - Deploy Vector Database<a class="headerlink" href="#deploy-vector-database" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/webapps/qdrant-helm
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>helm repo add qdrant https://qdrant.github.io/qdrant-helm
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>helm repo list
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl create ns qdrant
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>helm -n qdrant install qdrant --values values.yaml qdrant/qdrant
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl -n qdrant get po,svc
</pre></div>
</div>
<img alt="../_images/class3-21.png" src="../_images/class3-21.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ensure all pods are in <strong>Running</strong> and <strong>READY</strong> state where all pods count ready before proceed.</p>
</div>
<p>Create nginx ingress resource for qdrant vectordb to expose vectordb service to outside of K8S.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/webapps/qdrant-helm/nginx-ingress-qdrant
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl -n qdrant apply -f qdrant-ingress-http.yaml
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl -n qdrant apply -f qdrant-ingress-https-ui.yaml
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl -n qdrant get ingress
</pre></div>
</div>
<img alt="../_images/class3-22.png" src="../_images/class3-22.png" />
<p>Confirm that you can login to Qdrant vector database</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">There is no authentication setup for qdrant console/dashboard. Hence, no login prompt. Its for lab and demo only. Ensure strong authentication is enforced in production environment.</p>
</div>
<img alt="../_images/class3-23.png" src="../_images/class3-23.png" />
</div>
<div class="section" id="build-rag-pipeline-with-langchain">
<h2>8 - Build RAG pipeline with Langchain<a class="headerlink" href="#build-rag-pipeline-with-langchain" title="Permalink to this headline">¶</a></h2>
<p>Load the imported “arcadia-rag” chatflow.</p>
<img alt="../_images/class3-24.png" src="../_images/class3-24.png" />
<p>Here is the full RAG pipeline implmented in a low-code platform.</p>
<img alt="../_images/class3-25.png" src="../_images/class3-25.png" />
<p>Here are some of the node/chain used.</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Node / Chain</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Recursive Character Text Splitter</strong></p>
<blockquote class="last">
<div><p>Chunck Size: 250</p>
<p>Chunk Overlap : 20</p>
</div></blockquote>
</td>
<td>Split documents recursively by different characters -
starting with “nn”, then “n”, then ” “.</td>
</tr>
<tr class="row-odd"><td><p class="first"><strong>Text File</strong></p>
<p>Txt File:</p>
<blockquote class="last">
<div>arcadia-team-with-sensitive-data-v2.txt</div></blockquote>
</td>
<td>Load data from text file</td>
</tr>
<tr class="row-even"><td><p class="first"><strong>Ollama Embeddings</strong></p>
<p>Base URL:</p>
<blockquote>
<div><a class="reference external" href="http://ollama.ai.local">http://ollama.ai.local</a></div></blockquote>
<p>Model Name:</p>
<blockquote class="last">
<div>nomic-embed-text</div></blockquote>
</td>
<td>Generate embeddings for a given text using open source model on Ollama</td>
</tr>
<tr class="row-odd"><td><p class="first"><strong>Qdrant</strong></p>
<p>Qdrant Server URL:</p>
<blockquote>
<div><a class="reference external" href="http://vectordb.ai.local">http://vectordb.ai.local</a></div></blockquote>
<p>Qdrant Collection Name:</p>
<blockquote class="last">
<div>qdrant_arcadia</div></blockquote>
</td>
<td>Qdrant vector database node. Node to define vector db
locations, variable and collection name</td>
</tr>
<tr class="row-even"><td><p class="first"><strong>ChatOllama</strong></p>
<p>Base URL URL:</p>
<blockquote>
<div><a class="reference external" href="http://ollama.ai.local">http://ollama.ai.local</a></div></blockquote>
<p>Model Name:</p>
<blockquote>
<div>llama3.2:1b</div></blockquote>
<p>Temperature:</p>
<blockquote class="last">
<div>0.9</div></blockquote>
</td>
<td>A chat completion node for using LLM on Ollama.</td>
</tr>
<tr class="row-odd"><td><p class="first"><strong>Conversational Retrieval QA</strong></p>
<p>Chat Model</p>
<p>Vector Store Retriever</p>
<p class="last">Memory</p>
</td>
<td>A chain for performing question-answering tasks with
a retrieval component.</td>
</tr>
<tr class="row-even"><td><strong>Buffer Memory</strong></td>
<td>Use Flowise database table chat_message as the
storage mechanism for storing/retrieving conversations.</td>
</tr>
</tbody>
</table>
<div class="section" id="vectorize-proprietary-data">
<h3>Vectorize Proprietary Data<a class="headerlink" href="#vectorize-proprietary-data" title="Permalink to this headline">¶</a></h3>
<p>RAG incorporate proprietary data to complement models and deliver more contextually aware AI outputs. However, in NLP (Neural Language Processing), AI don’t understand human language. Those texts or knowledge need to be converted into an understandable language by NLP where the process called embedding required to convert text into series of vector array.</p>
<p>nomic-embed-text is an embedding model that able to convert text into a vector array. In order for nomic-embed-text to work, the Qdrant dimention have to be updated to 768.</p>
<p>From Windows Jumphost, update the Qdrant Chain dimention to 768.</p>
<p>Click on “Additional Parameter”</p>
<img alt="../_images/class3-26.png" src="../_images/class3-26.png" />
<p>Ensure “Vector Dimension” is 768 and “Similarity” is “Cosine”</p>
<img alt="../_images/class3-27.png" src="../_images/class3-27.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click anywhere outside to exit from the pop-up</p>
</div>
<p>Click “Upsert Vector Database”</p>
<img alt="../_images/class3-28.png" src="../_images/class3-28.png" />
<img alt="../_images/class3-29.png" src="../_images/class3-29.png" />
<p>Successfully upserted vector store.</p>
<img alt="../_images/class3-30.png" src="../_images/class3-30.png" />
<p>Login to Qdrant Dashboard to confirm vectordb created.</p>
<img alt="../_images/class3-31.png" src="../_images/class3-31.png" />
</div>
<div class="section" id="test-your-first-gen-ai-rag-chatbot">
<h3>Test your first Gen AI RAG Chatbot<a class="headerlink" href="#test-your-first-gen-ai-rag-chatbot" title="Permalink to this headline">¶</a></h3>
<p>Click the Chat Icon</p>
<img alt="../_images/class3-32.png" src="../_images/class3-32.png" />
<p>Input on the chat box</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>who is chairman of the board
</pre></div>
</div>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">You are using CPU for inference. Hence, expect some delay in the response.</p>
</div>
<p>Sample RAG Chatbot conversation</p>
<img alt="../_images/class3-33.png" src="../_images/class3-33.png" />
<p>Suggested sample question ask to the RAG chatbot</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>give me all the name from the board of director
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>who is chris wong
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tell me more about david strong
</pre></div>
</div>
<p>Source of inforamtion “proprietary data” obtained from the text file store on the Windows desktop under document folder.</p>
<img alt="../_images/class3-34.png" src="../_images/class3-34.png" />
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Generic Small Language Model may not be as efficient compare to a LLM and may constantly encounter hallucination. You may modify the chunking size and chuking overlap to reduce hallucination. For the purpose of a lab, we are not expecting the model to provides an accurate and intelligent answer.</p>
</div>
<p>You have successfully build a Generative RAG Chatbot.</p>
<img alt="../_images/mission3-1.png" src="../_images/mission3-1.png" />
<div class="toctree-wrapper compound">
</div>
</div>
</div>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="../class2/class2.html" title="Class 2: Deploy and Secure a modern application" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="../class4/class4.html" title="Class 4: Enhance Modern Application with GenAI ChatBot" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../_static/js/index.js"></script>
  <script src="../_static/js/jquery.appear.js"></script>
  <script src="../_static/js/printThis.js"></script>
  <script src="../_static/js/bootstrap.min.js"></script>
  <script src="../_static/js/clouddocs.js"></script>
  <script src="../_static/js/CoveoJsSearch.Lazy.min.js"></script>
  </body>
</html>